local C = {}
  C.alpha = 0
  C.white = 1
  C.orange = 2
  C.magenta = 4
  C.lightBlue = 8
  C.yellow = 16
  C.lime = 32
  C.pink = 64
  C.gray = 128
  C.lightGray = 256
  C.cyan = 512
  C.purple = 1024
  C.blue = 2048
  C.brown = 4096
  C.green = 8192
  C.red = 16384
  C.black = 32768

local currentColor = {C.white, C.black}
local width, height = term.getSize()

local Cursor = CPI.object()

function newCursor(x,y,t,b)
  local self = CPI.object(Cursor)
  if x then self.x = x else x = getCursorX() end
  if y then self.y = y else y = getCursorY() end
  if t then self.t = t else t = getColorT() end
  if b then self.b = b else b = getColorB() end
  
  return self
end

function Cursor:setCursor(x,y) self.x = x self.y = y return self end
function Cursor:setColor(t,b) self.t = t self.b = b return self end
function Cursor:update() update(self.x,self.y,self.t,self.b) return self end
function Cursor:write(s) self:update() write(s) end
function Cursor:writeln(s) update() writeln(s) end

function getCursor() return term.getCursorPos() end
function getCursorX() local x,_ = getCursor() return x end
function getCursorY() local _,y = getCursor() return y end
function setCursor(x,y) term.setCursorPos(x,y) end
function setCursorX(x) setCursor(x, getCursorY()) end
function setCursorY(y) setCursor(getCursorX(), y) end

function getColor() return currentColor[1], currentColor[2] end
function getColorT() return currentColor[1] end
function getColorB() return currentColor[2] end
function setColor(t,b) term.setTextColor(t) term.setBackgroundColor(b) currentColor = {t,b} end
function setColorT(t) term.setTextColor(t) currentColor[1] = t end
function setColorT(t) term.setBackgroundColor(b) currentColor[2] = b end

function getSize() return width, height end
function getColors() return C end
function update(x,y,t,b) setCursor(x,y) setColor(t,b) end
function write(s) term.write(s) end
function writeln(s) write(s) s = tostring(s) if getCursorY() == height then term.scroll(1) setCursor(getCursorX()-tonumber(s:len()), height) else setCursor(getCursorX()-tonumber(s:len()), getCursorY()+1) end end